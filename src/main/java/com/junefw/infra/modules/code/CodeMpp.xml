<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.junefw.infra.modules.code.CodeMpp">	<!-- 지금 파일 지정 -->

    <resultMap id="resultMapObj" type="com.junefw.infra.modules.code.Code"></resultMap> <!-- 결과 객체 저장 -->

	<select id="selectList" resultMap="resultMapObj">
			SELECT
				a.ifcgSeq
				, a.ifcgName
				, a.ifcgDelNy
			FROM 
				rb.infrcodegroup a
			WHERE 1=1
				<choose>
					<when test="shIfcgDelNy == 1">AND ifcgDelNy = 1</when>
					<when test="shIfcgDelNy == 0">AND ifcgDelNy = 0</when>
				</choose>
				<if test="shIfcgName != null and !shIfcgName.equals('')"> AND ifcgName LIKE concat('%',#{shIfcgName},'%')</if>
	</select>
	
	<select id="searchList" resultMap="resultMapObj">
			SELECT
				a.ifcgSeq
				, a.ifcgName
				, a.ifcgDelNy
			FROM 
				rb.infrcodegroup a
			WHERE 1=1
				AND ifcgDelNy = 0
				AND ifcgName = #{shIfcgName}
	</select>
	
	<insert id="insert">
			INSERT INTO infrCodeGroup(
				ifcgName
				, ifcgDelNy
			) VALUES (
				#{ifcgName}
				,0
			)
	</insert>
	
	<select id="selectOne" resultMap="resultMapObj">
			SELECT
				a.ifcgSeq
				, a.ifcgName
				, a.ifcgDelNy
			FROM 
				rb.infrcodegroup a
			WHERE 1=1
				AND ifcgSeq = #{ifcgSeq}
	</select>
	
	<update id="update">
			UPDATE
				rb.infrcodegroup a
			SET
				a.ifcgName = #{ifcgChangeName}
			WHERE 1=1
				AND ifcgSeq = #{ifcgSeq}
	</update>
	
	<update id="update2">
			UPDATE
				rb.infrcodegroup
			SET 
				ifcgName = #{ifcgName}
			WHERE 1=1
				AND ifcgSeq = #{ifcgSeq}
	</update>
	
	<!-- code -->
	
	<select id="selectCodeList" resultMap="resultMapObj">
			SELECT
				a.ifcdSeq
				, a.ifcdName
				, a.ifcdDelNy
				, (select ifcgName from infrCodeGroup where a.ifcgSeq = infrCodeGroup.ifcgSeq) as ifcgName
			FROM 
				rb.infrcode a
			WHERE 1=1
				AND ifcdDelNy = 0
	</select>
	
	<select id="selectCodeOne" resultMap="resultMapObj">
			SELECT
				a.ifcdSeq
				, a.ifcdName
				, a.ifcdDelNy
			FROM 
				rb.infrcode a
			WHERE 1=1
				AND ifcdSeq = #{ifcdSeq}
	</select>
	<insert id="insertCode">
			INSERT INTO infrCode(
				ifcdName
				, ifcdDelNy
				, ifcgSeq
			) VALUES (
				#{ifcdName}
				,0
				,#{ifcgSeq}
			)
	</insert>
	<update id="updateCode">
			UPDATE
				rb.infrcode
			SET 
				ifcdName = #{ifcdName}
			WHERE 1=1
				AND ifcdSeq = #{ifcdSeq}
	</update>
</mapper>